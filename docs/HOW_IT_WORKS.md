# ๐ง ะะฐะบ ัะฐะฑะพัะฐะตั ัะธััะตะผะฐ

## ๐ฑ ะะพะปะฝัะน ัะธะบะป ัะฐะฑะพัั

### ะจะฐะณ 1: ะะพะดะณะพัะพะฒะบะฐ ะฐะบะบะฐัะฝัะพะฒ

```
ะะฟะตัะฐัะพั โ ะกะพะทะดะฐะตั ัะฟะธัะพะบ ะฝะพะผะตัะพะฒ โ local-storage/phones/accounts.txt
```

### ะจะฐะณ 2: ะะพะปััะตะฝะธะต ัะตััะธะน

```
ะกะบัะธะฟั โ ะะปั ะบะฐะถะดะพะณะพ ะฝะพะผะตัะฐ:
  - ะัะฟัะฐะฒะปัะตั ะบะพะด ะฒ Telegram
  - ะั ะฒะฒะพะดะธัะต ะบะพะด (ะพะดะธะฝ ัะฐะท!)
  - ะกะพััะฐะฝัะตั session ะฒ:
    โข 79001234567.json
    โข 79001234567.session
```

### ะจะฐะณ 3: ะะฐะฟััะบ Worker

```
Control API โ ะกะพะทะดะฐะตั Job ะฒ Kubernetes โ Worker Pod ะทะฐะฟััะบะฐะตััั
```

### ะจะฐะณ 4: ะะฒัะพัะธะทะฐัะธั Worker

```
Worker โ ะะฐะณััะถะฐะตั session โ ะะฒัะพัะธะทัะตััั ะะะ ะบะพะดะฐ โ ะะพัะพะฒ ะบ ัะฐะฑะพัะต
```

### ะจะฐะณ 5: ะัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐั

```
Worker โ ะัะฟะพะปะฝัะตั warm-up ัะบัะธะฟั:
  - ะัะพะฒะตัะบะฐ ัะพะตะดะธะฝะตะฝะธั
  - ะะพะปััะตะฝะธะต ะธะฝัะพัะผะฐัะธะธ
  - ะงัะตะฝะธะต ะดะธะฐะปะพะณะพะฒ
  - ะััะณะธะต ะดะตะนััะฒะธั
```

### ะจะฐะณ 6: ะััะตั

```
Worker โ ะัะฟัะฐะฒะปัะตั ะพััะตั โ Control API โ ะกะพััะฐะฝัะตั ะฒ ะะ
```

## ๐ฏ ะะตัะฐะปัะฝะพะต ะพะฟะธัะฐะฝะธะต ะบะพะผะฟะพะฝะตะฝัะพะฒ

### Control Node (API)

**ะงัะพ ะดะตะปะฐะตั:**
- ะัะธะฝะธะผะฐะตั ะทะฐะฟัะพัั ะฝะฐ ัะพะทะดะฐะฝะธะต ะทะฐะดะฐั
- ะฃะฟัะฐะฒะปัะตั ะพัะตัะตะดัั ะทะฐะดะฐั (Redis)
- ะฅัะฐะฝะธั ะธะฝัะพัะผะฐัะธั ะฒ ะะ (Postgres)
- ะัะตะดะพััะฐะฒะปัะตั Web UI ะดะปั ะพะฟะตัะฐัะพัะพะฒ

**ะัะธะผะตั ะทะฐะฟัะพัะฐ:**
```bash
POST /api/v1/jobs/create
{
  "phone_number": "+79001234567",
  "script_id": "warmup_script_v1"
}
```

### Android Worker

**ะงัะพ ะดะตะปะฐะตั:**
1. ะะฐะณััะถะฐะตั session (ะปะพะบะฐะปัะฝะพ ะธะปะธ ะธะท S3)
2. ะะฒัะพัะธะทัะตััั ะฒ Telegram
3. ะัะฟะพะปะฝัะตั warm-up ัะบัะธะฟั
4. ะัะฟัะฐะฒะปัะตั ะพััะตั

**ะัะธะผะตั ะฒัะฟะพะปะฝะตะฝะธั:**
```python
# Worker ะฐะฒัะพะผะฐัะธัะตัะบะธ:
1. load_session_local("+79001234567")
   โ ะะฐัะพะดะธั 79001234567.json ะธะปะธ 79001234567.session
   
2. TelegramClient(session)
   โ ะะฒัะพัะธะทัะตััั ะะะ ะบะพะดะฐ
   
3. execute_warmup_script()
   โ ะัะฟะพะปะฝัะตั ะดะตะนััะฒะธั
   
4. report_to_control_api()
   โ ะัะฟัะฐะฒะปัะตั ัะตะทัะปััะฐัั
```

### WireGuard Proxy

**ะงัะพ ะดะตะปะฐะตั:**
- ะกะพะทะดะฐะตั VPN ััะฝะฝะตะปั ะฝะฐ ะบะฐะถะดะพะผ worker node
- ะัะต ะธััะพะดััะธะต ะทะฐะฟัะพัั ะธะดัั ัะตัะตะท ัะพััะธะนัะบะธะน IP
- Telegram ะฒะธะดะธั ัะพััะธะนัะบะธะน IP ะฐะดัะตั

**ะะฐะบ ัะฐะฑะพัะฐะตั:**
```
Pod โ Node Network โ WireGuard Tunnel โ VDS ะฒ ะะค โ Telegram
```

## ๐ ะัะธะผะตั ะฟะพะปะฝะพะณะพ ัะธะบะปะฐ

### ะกัะตะฝะฐัะธะน: ะัะพะณัะตะฒ 10 ะฐะบะบะฐัะฝัะพะฒ

**1. ะะพะดะณะพัะพะฒะบะฐ:**
```bash
# ะกะพะทะดะฐัั ัะฐะนะป ั ะฝะพะผะตัะฐะผะธ
echo "+79001234567" > local-storage/phones/accounts.txt
echo "+79001234568" >> local-storage/phones/accounts.txt
# ... ะตัะต 8 ะฝะพะผะตัะพะฒ
```

**2. ะะพะปััะตะฝะธะต ัะตััะธะน:**
```bash
python scripts/batch-get-sessions.py local-storage/phones/accounts.txt
```

**ะะตะทัะปััะฐั:**
```
local-storage/sessions/
โโโ 79001234567.json
โโโ 79001234567.session
โโโ 79001234568.json
โโโ 79001234568.session
โโโ ... (ะตัะต 8 ะฟะฐั)
```

**3. ะะฐะฟััะบ Worker'ะพะฒ:**
```bash
# ะ Kubernetes ัะพะทะดะฐัััั 10 Jobs
for phone in $(cat local-storage/phones/accounts.txt); do
  kubectl create job warmup-$(echo $phone | tr -d '+') \
    --from=jobtemplate/android-worker
done
```

**4. Worker ะฒัะฟะพะปะฝัะตั:**
```
Job 1: +79001234567
  โ ะะฐะณััะถะฐะตั 79001234567.session
  โ ะะฒัะพัะธะทัะตััั
  โ ะัะฟะพะปะฝัะตั warm-up
  โ ะัะฟัะฐะฒะปัะตั ะพััะตั

Job 2: +79001234568
  โ ะะฐะณััะถะฐะตั 79001234568.session
  โ ะะฒัะพัะธะทัะตััั
  โ ะัะฟะพะปะฝัะตั warm-up
  โ ะัะฟัะฐะฒะปัะตั ะพััะตั

... (ะตัะต 8 Jobs)
```

**5. ะะตะทัะปััะฐั:**
- โ 10 ะฐะบะบะฐัะฝัะพะฒ ะฐะฒัะพัะธะทะพะฒะฐะฝั
- โ 10 ะฐะบะบะฐัะฝัะพะฒ "ะฟัะพะณัะตัั"
- โ ะััะตัั ะฒ Control API
- โ ะะพัะพะฒั ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

## ๐ ะะฒัะพะผะฐัะธะทะฐัะธั

### ะะฐัะฟะธัะฐะฝะธะต

ะะพะถะฝะพ ะฝะฐัััะพะธัั ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ:

```yaml
# CronJob ะดะปั ะตะถะตะดะฝะตะฒะฝะพะณะพ ะฟัะพะณัะตะฒะฐ
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-warmup
spec:
  schedule: "0 2 * * *"  # ะะฐะถะดัะน ะดะตะฝั ะฒ 2:00
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: android-worker
            # ... ะบะพะฝัะธะณััะฐัะธั
```

### ะะฐััะพะฒะฐั ะพะฑัะฐะฑะพัะบะฐ

```python
# Control API ะผะพะถะตั ัะพะทะดะฐะฒะฐัั Jobs ะฐะฒัะพะผะฐัะธัะตัะบะธ
for phone in phone_list:
    create_job(phone=phone, script="warmup_script_v1")
```

## ๐ฏ ะัะพะณะพะฒะฐั ััะตะผะฐ

```
โโโโโโโโโโโโโโโโโโโ
โ   ะะฟะตัะฐัะพั      โ
โ   (Web UI)      โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  Control API    โ โ ะกะพะทะดะฐะตั ะทะฐะดะฐัะธ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  Redis Queue   โ โ ะัะตัะตะดั ะทะฐะดะฐั
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  Kubernetes     โ
โ  Job Pods       โ โ Worker'ั
โโโโโโโโโโฌโโโโโโโโโ
         โ
    โโโโโโดโโโโโ
    โ         โ
    โผ         โผ
โโโโโโโโโโ โโโโโโโโโโโโ
โSession โ โTelegram  โ
โFiles   โ โAPI       โ
โโโโโโโโโโ โโโโโโโโโโโโ
```

## โ ะงัะพ ะฟะพะปััะฐะตััั

1. **ะะฒัะพะผะฐัะธะทะฐัะธั** - ะฝะต ะฝัะถะฝะพ ะฒัััะฝัั ัะฐะฑะพัะฐัั ั ะบะฐะถะดัะผ ะฐะบะบะฐัะฝัะพะผ
2. **ะะฐัััะฐะฑะธััะตะผะพััั** - ะผะพะถะฝะพ ะพะฑัะฐะฑะพัะฐัั ัััััะธ ะฐะบะบะฐัะฝัะพะฒ
3. **ะะฐะดะตะถะฝะพััั** - ะฒัะต ัะตัะตะท Kubernetes, ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะฟะตัะตะทะฐะฟััะบะธ
4. **ะะตะทะพะฟะฐัะฝะพััั** - ัะพััะธะนัะบะธะต IP, ะธะทะพะปััะธั, ะปะพะณะธัะพะฒะฐะฝะธะต
5. **ะััะตัะฝะพััั** - ะฒัะต ะดะตะนััะฒะธั ะปะพะณะธัััััั ะธ ะพััะตัั ะดะพัััะฟะฝั







